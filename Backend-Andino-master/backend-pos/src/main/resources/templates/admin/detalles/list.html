<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Detalle Ventas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
    <Div class="container mt-4">
        <h1>Detalle Ventas</h1>
        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
        <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>
        <p>
            <a th:href="@{/admin/ventas/descargar-detalle-csv}" class="btn btn-secondary">Descargar CSV</a>
        </p>

        <div th:each="entry : ${ventasAgrupadas}" class="mb-4">
            <h3 th:text="'Venta ID: ' + ${entry.key.id}"></h3>
            <p>
                <strong>Fecha:</strong> <span th:text="${#temporals.format(entry.key.fecha, 'dd-MM-yyyy HH:mm')}"></span><br>
                <strong>Usuario:</strong> <span th:text="${entry.key.usuario?.username}">Sin usuario</span><br>
                <strong>Total:</strong> <span th:text="${entry.key.total}"></span><br>
                <strong>IVA:</strong> <span th:text="${entry.key.iva}"></span>
            </p>
            <table class="table table-bordered">
                <thead class="table-dark">
                    <tr>
                        <th>Detalle ID</th>
                        <th>Producto</th>
                        <th>SubTotal</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="detalle : ${entry.value}">
                        <td th:text="${detalle.id}"></td>
                        <td th:text="${detalle.producto?.nombre}"></td>
                        <td th:text="${detalle.subtotal}"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <a th:href="@{/admin/dashboard}" class="btn btn-secondary">Volver al Dashboard</a>
    </Div>
</body>
</html>